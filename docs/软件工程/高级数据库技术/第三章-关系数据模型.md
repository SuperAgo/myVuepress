---
title: 第三章 关系数据模型
tags:
  - 高级数据库技术
categories:
  - 复习
date: 2020-08-10 09:49:00
---
## 关系数据库的结构
### 关系的相关概念
- 关系模型只包含单一的数据结构——**关系**
- 现实世界中的**实体集**和**联系集**都**用关系**表示
- 从用户角度来看，关系的逻辑结构就是一张“展平”的二维表
- 关系的概念源于数学中的**集合论**
- 从**集合论的角度**给出关系模型的相关概念
  - 域
  - 笛卡尔积
  - 关系

**域**：  
- 域是具有相同类型的值的集合
- 域可以是**有限集**，也可以是**无穷集**
- 如果域D为有限集时，则称D中元素的个数为D的**基数**，记作|D|

**笛卡尔积**：  
- 给定n个域D<sub>1</sub>,D<sub>2</sub>,…,D<sub>n</sub>（它们不必互不相同）上的笛卡尔积记作：**D<sub>1</sub>xD<sub>2</sub>x...D<sub>n</sub>**，且  
	D<sub>1</sub>xD<sub>2</sub>x...xD<sub>n</sub>={(d<sub>1</sub>,d<sub>2</sub>,…,d<sub>n</sub>)|d<sub>1</sub>∈D<sub>1</sub>∧d<sub>2</sub>∈D<sub>2</sub>∧…∧d<sub>n</sub>∈D<sub>n</sub>}
- 每个元素<b>(d<sub>1</sub>,d<sub>2</sub>,…,d<sub>n</sub>)</b>称为一个<b>n-元组</b>（简称元组），而d<sub>i</sub>为元组的第i个分量。若D<sub>1</sub>,D<sub>2</sub>,…,D<sub>n</sub>均为有限集，其基数为|D<sub>1</sub>|x|D<sub>2</sub>|x…x|D<sub>n</sub>|  
例如，有三个域：D<sub>1</sub>={0,1}，D<sub>2</sub>={a,b,c}，D<sub>2</sub>={D,E}则D<sub>1</sub>、D<sub>2</sub>、D<sub>3</sub>的笛卡尔积为：  
**D<sub>1</sub>xD<sub>2</sub>xD<sub>3</sub>**={(0,a,D),(0,a,E),(0,b,D),(0,b,E),(0,c,D),(0,c,E),(1,a,D),(1,a,E),(1,b,D),(1,b,E),(1,c,D),(1,c,E)},其基数为|D<sub>1</sub>|x|D<sub>2</sub>|x|D<sub>3</sub>|=12

**关系**：  
- 域D<sub>1</sub>,D<sub>2</sub>,…,D<sub>n</sub>上的关系r是笛卡尔积D<sub>1</sub>xD<sub>2</sub>x...xD<sub>n</sub>的任意子集。n个域上的关系称为<b>n-元关系</b>，“**元**”又称**目**或**度**  
例如，{(0,a,D),(1,b,E),(1,c,D)}是上面提到的笛卡尔积D<sub>1</sub>xD<sub>2</sub>xD<sub>3</sub>的一个子集，它可以看作域D<sub>1</sub>、D<sub>2</sub>、D<sub>3</sub>上的一个二元关系

**关系的另一种表示形式**：  
- 关系还可以使用二维表来表示
- 每个表都有一个唯一的名字（关系名），表的每一列对应的分量称为**属性**，表的每一行是**表头**，给出各列的属性名，其余每行对应于一个元组，**每个元组**都**代表一个实体**或**联系**
- 关系的这种直观表示允许我们对关系附加一些语义
- 例如，我们可以通过**属性名解释关系元组的语义**，可以通过**属性的语义**定义**关系的码**，定义**关系的完整性约束**

**关系的性质**：  
- 关系是笛卡尔积的子集，即元组的集合。所以**关系中行的次序不重要**，且关系（表）中不能包含两个相同的元组（行)
- 用二维表表示关系使得我们可以以任意列次序显示关系，或者说**列的顺序不重要**
- 在关系数据库中，任何有意义的关系都需要满足一定的约束条件。这些约束都是语义约束，包括关系的完整性约束和数据依赖

**注意**：  
除了语义约束外，对关系的限制主要有两点  
- 在关系数据库中，**只考虑有限关系**，因为无限关系既不能显示存储，也不能有效的显示
- **关系的每个属性都必须是原子的**，**原子值**指的是不可再分的值。属性的原子性要求是规范化关系的基本要求

### 关系的码
**码**：  
- 超码
- 候选码
- 主码

**超码**:  
- 属性集X是关系R的**超码**，如果在R的所有可能实例上都不存在两个不同的元组，它们在X上都具有相同的值
- 属性集K是关系R的**码**，如果K是R的超码，并且K的任何真子集都不是R的超码
  - 码的选择依赖于实际问题的语义，而不是关系的当前值
  - 一个关系可能有多个码

**主码**:  
- 通常，当一个关系具有多个码时，应当**选择其中的一个**作为唯一识别关系元组的码，称为**主码**
- 主码用于表示由多个码中选出的作为唯一识别关系元组的码，而所有的码又称**候选码**
- 码中的属性称为**主属性**，而不在任何码中出现的属性称为非主属性

### 关系模式
**关系模式**概念对应于程序设计语言中的类型概念，是对关系型的描述，可以表示为R(U,D,DOM,F)  
- **R**为**关系模式名**
- **U**为**关系模式的主属性**
- **D**为**属性对应的域**
- **DOM**为**U到D的映射**
- **F**为**属性间的数据依赖集定义**

:::tip
注意：在不需要详细考虑属性的域和属性之间的数据依赖时，我们把关系模式简记为R(A<sub>1</sub>,A<sub>2</sub>,...,A<sub>n</sub>)其中R是关系模式名。A<sub>1</sub>,A<sub>2</sub>,...,A<sub>n</sub>是属性名，或者简写为R(U)。在实际的关系数据库中进行某个关系的定义时还要给出各个属性的数据类型、取值范围和完整性约束
:::

**关系有型和值之分**：  
关系的型：  
- 关系模式看作“类型”
- 关系的型用关系模式刻画

关系的值：  
- 关系就是具有特定类型的“变量”
- 关系的**值**即关系在某一时刻的快照，又称关系**实例**

例子：  
- 关系模式Students(Sno,Sname,Sex,Birthday)
  - Students是关系模式名，Sno，Sname，Sex，Birthday分别是属性名
  - Students(Sno,Sname,Sex,Birthday)构成了students这个关系模式的型
  - Students的实例
- 关系的值是随着时间变化的

## 从E-R模型到关系模型
### E-R图向关系模型的转换
包括：属性处理、实体集处理、联系集处理

属性处理：  
- 派生属性的处理：转换时我们忽略派生属性
- 复合属性的处理：忽略复合属性本身，而直接考虑它的成分属性
- 多值属性的处理：为每个多值属性M创建一个关系R<sub>M</sub>

实体集处理：  
- 强实体集处理
  - 每个强实体集用一个关系表示
  - 实体集名可以作为关系名，实体集的全部属性构成关系的属性
- 弱实体集处理
  - 每个弱实体集用一个关系表示
  - 弱实体集名可以作为关系名，弱实体集存在依赖的标识实体集的主码和弱实体集的全部属性构成关系的属性

联系集的处理：  
- 联系是一对一的，则每个实体集的码都是关系的码
- 联系时一对多（多对一）的，则“多端”实体集的码组合成关系的码
- 联系是多对多的，则参与联系的所有实体集的码组合成关系的码

**总结**：
- 将每个强实体集用一个关系表示；
- 将每个弱实体集用一个关系表示；
- 将联系集用相应的方法转换成关系表示；
- 如果两个关系具有相同的码，则可以合并它们；

## 关系操作
### 关系语言的分类
- 关系代数
- 关系演算
- SQL语言
### 关系操作的特点
- 关系操作可以分为查询和更新两类
- 不管是查询还是更新操作，关系操作的对象和结果都是关系
- 关系操作的特点是集合操作方式

## 关系的完整性约束
### 关系分类
- 基本关系（实关系，实表）
- 视图（虚关系，虚表）

### 完整性分类
- 实体完整性
- 参照完整性
- 用户自定义的完整性

### 关系的完整性约束
- 空值
  - 空值意指“缺失的值”，它是目前尚不知道的值，通常用null表示
- 实体完整性
  - 实体完整性规则：**关系R的所有元组在主码上的值必须唯一，并且在主码的任何属性上都不能取空值**
- 参照完整性
  - 参照完整性规则：**如果属性集FK是关系R的外码，它参照关系S的主码K<sub>s</sub>，则R的任何元祖在Fk上的值或者等于S的某个元组在主码K<sub>s</sub>上的值，或者为空值**
- 用户定义的完整性
  - 用户定义的完整性规则：**用户定义的完整性范颖特定的数据库所涉及的数据必须满足的语义约束条件。由于不存在一般性规则，这些约束条件必须由用户根据实际问题的语义制定**
## 关系代数
### 关系代数的五种基本运算符
- 选择运算
- 投影运算
- 并运算
- 差运算
- 笛卡尔积
### 附加的关系运算符
- 交运算
- 除运算
- 连接运算
- 自然连接运算
### 关系代数表达查询
关系代数表达式形式地定义如下:  
(1)数据库中的关系和常量关系（显式给出的元组集合）是关系代数表达式。  
(2)如果E是关系代数表达式，则ρ<sub>F</sub>(E)也是，其中F是选择条件。  
(3)如果E是关系代数表达式，X是E中的属性列表，则π<sub>x</sub>(E)是关系代数表达式。
(4)如果E<sub>1</sub>和E<sub>2</sub>是关系代数表达式，则明E<sub>1</sub>∪E<sub>2</sub>、E<sub>1</sub>-E<sub>2</sub>、E<sub>1</sub>xE<sub>2</sub>、E<sub>1</sub>∩E<sub>2</sub>、E<sub>1</sub>÷E<sub>2</sub>、E<sub>1</sub><sub>⋈F</sub>E<sub>2</sub>和E<sub>1</sub>⋈E<sub>2</sub>,都是关系代数表达式

## 本章测验
1【单选题】下面对主码取值限制的是（  ）  
A、实体完整性    B.参照完整性  C.用户自定义的完整性  D.以上都不对  

2【单选题】下面对外码取值限制的是（  ）  
A、实体完整性    B.参照完整性  C.用户自定义的完整性  D.以上都不对  

3【单选题】下面可以取空值的是（  ）  
A、主码    B.外码    C.候选码  D.超码  

4【单选题】下面各个选项中的所有属性不能取空值的是（  ）  
A、主码  B.外码  C.超码   D.以上都不对  

5【单选题】下面说法正确的是（  ）  
A、关系中可以有两个完全相同的元组  B.二维表表示关系时行的次序不重要
B、二维表表示关系时列的次序重要    D.二维表和关系是同一个概念  

6【单选题】下面可以描述参照关系的是（  ）  
A、主码    B.外码    C.候选码  D.超码  

7【单选题】E-R图向关系模式转换时实体被转换为（  ）  
A、关系    B.元组    C.记录  D.以上都不对  

8【单选题】E-R图向关系模式转换时对多值属性如何处理（  ）  
A、忽略  B.展平技术，忽略复合属性本身，直接使用其成分属性代替  C.为其创建一个新的关系模式   D.以上都不对  

9【单选题】E-R图向关系模式转换时对复合属性如何处理（  ）  
A、忽略  B.展平技术，忽略复合属性本身，直接使用其成分属性代替  C.为其创建一个新的关系模式   D.以上都不对  

10【单选题】E-R图向关系模式转换时对派生属性如何处理（  ）  
A、忽略  B.展平技术，忽略复合属性本身，直接使用其成分属性代替  C.为其创建一个新的关系模式   D.以上都不对  

11【单选题】如果联系是一对多的，转换成关系模型后使用（  ）作为码  
A、一端实体的码   B.多端实体的码   C.一端和多端实体的码的联合   D.一端或多端实体的码都可以作为码  

12【单选题】如果实体集M和实体集N之间的联系是多对多的，转换成关系模型后使用（  ）作为码  
A、实体集M的码   B.实体集N的码   C.实体集M和N的码的联合   D.以上都可以  

13【单选题】关系代数的五种基本运算是（  ）  
A、并.交.差.除.选择  B.并.交.差.除.投影  C.并.交.差.投影.选择   D.并.差.投影.选择.笛卡儿积  

14【单选题】下面属于一元运算的是（  ）  
A、选择运算  B.并运算  C.交运算   D.除运算  

15【单选题】必须有同名属性才能进行的运算是（  ）  
A、选择运算  B.等值连接  C.笛卡儿积   D.自然连接  

16【单选题】下面属于行运算的是（  ）  
A、选择运算  B.投影运算  C.笛卡儿积   D.等值连接  

17【单选题】下面属于列运算但伴随着行删除的是（  ）  
A、选择运算  B.投影运算  C.笛卡儿积   D.等值连接  

18【单选题】由属于R但不属于S的所有元组组成的结果关系是（  ）  
A、R并S  B.R交S  C.R差S   D.R除S  

19【单选题】笛卡儿积运算的逆运算是（  ）  
A、并运算  B.交运算  C.差运算   D.除运算  

20【单选题】R和S分别有n和m个属性，做哪个运算属性数目增加（  ）  
A、并运算  B.交运算  C.差运算   D.笛卡儿积运算